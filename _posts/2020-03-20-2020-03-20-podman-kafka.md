---
layout: post
published: false
title: 2020-03-20-podman-kafka
---
## A New Post
** clean-up containers
```bash
bash << EOF
podman stop $(podman ps -a -q)
podman rm $(podman ps -a -q)
podman rmi $(podman images -a -q)
podman volume prune -f
podman ps -a
podman images -a
podman volume ls
```
   
** create podman zookeeper
```bash
podman run -d \
    --net=host \
    --name=zookeeper \
    -e ZOOKEEPER_CLIENT_PORT=32181 \
    -e ZOOKEEPER_TICK_TIME=2000 \
    confluentinc/cp-zookeeper:5.3.1-1
```   
   
** create kafka broker 
```bash
podman run -d \
    --net=host \
    --name=kafka \
    -e KAFKA_ZOOKEEPER_CONNECT=localhost:32181 \
    -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:29092 \
    -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \
    -p 29092:29092 \
    confluentinc/cp-kafka:5.3.1-1
```   
   
** create schema registry
```bash
podman run -d \
  --net=host \
  --name=schema-registry \
  -e SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL=localhost:32181 \
  -e SCHEMA_REGISTRY_HOST_NAME=localhost \
  -e SCHEMA_REGISTRY_LISTENERS=http://localhost:8081 \
  -p 8081:8081 \
  confluentinc/cp-schema-registry:5.3.1-1
```   
   
** create topics
```bash
podman run \
  --net=host \
  --rm \
  confluentinc/cp-kafka:5.3.1-1 \
  kafka-topics --create --topic quickstart-avro-offsets --partitions 1 --replication-factor 1 --if-not-exists --zookeeper localhost:32181
```
```bash
podman run \
  --net=host \
  --rm \
  confluentinc/cp-kafka:5.3.1-1 \
  kafka-topics --create --topic quickstart-avro-config --partitions 1 --replication-factor 1 --if-not-exists --zookeeper localhost:32181
```   
```bash
podman run \
  --net=host \
  --rm \
  confluentinc/cp-kafka:5.3.1-1 \
  kafka-topics --create --topic quickstart-avro-status --partitions 1 --replication-factor 1 --if-not-exists --zookeeper localhost:32181
```   
   
** verify topic creation
```bash
podman run \
   --net=host \
   --rm \
   confluentinc/cp-kafka:5.3.1-1 \
   kafka-topics --describe --zookeeper localhost:32181
```   
   
** start mysql db container
```bash
podman run -d \
    --name quickstart-mysql \
    --net=host \
    -e MYSQL_USER=confluent \
    -e MYSQL_PASSWORD=confluent \
    -e MYSQL_DATABASE=connect_test \
    -p 3306:3306 \
    rhscl/mysql-57-rhel7
```   
   
